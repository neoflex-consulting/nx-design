import { NotificationExampleSimple } from './examples/NotificationExampleSimple/NotificationExampleSimple';
import { NotificationExampleStatus } from './examples/NotificationExampleStatus/NotificationExampleStatus';
import { NotificationExampleIcon } from './examples/NotificationExampleIcon/NotificationExampleIcon';
import { NotificationExampleWithButtons } from './examples/NotificationExampleWithButtons/NotificationExampleWithButtons';
import { NotificationExampleTimer } from './examples/NotificationExampleTimer/NotificationExampleTimer';
import { NotificationExampleButtons } from './examples/NotificationExampleButtons/NotificationExampleButtons';
import { NotificationExampleView } from './examples/NotificationExampleView/NotificationExampleView';

# Notification

Используется для мгновенных уведомлений.

Notification (в отличие от [alert](?path=/docs/components-alert--playground))
всегда перекрывает основное содержимое, выносится в отдельный слой интерфейса
и сопровождается анимацией. На него будет направлено всё внимание пользователя.

Используйте alert в контексте, notification — вне контекста.

- [Текст сообщения](#текст-сообщения)
- [Статус](#статус)
- [Иконка](#иконка)
- [Кнопки](#кнопки)
- [Таймер](#таймер)
- [Список свойств](#свойства)
- [Пример использования](#пример)

## Текст сообщения

За текст сообщения отвечает `message`.

Пишите коротко и лаконично. С заглавной, точка не нужна.

## Статус

От статуса зависит иконка на уведомлении (задается в свойстве `status`).

<NotificationExampleStatus />

```tsx
const items: Item[] = [
  {
    key: 1,
    message: 'This is dialog',
    status: 'info',
    title: 'Label Header',
    withCloseButton: true,
    icon: <IconInfo size={"m"}/>,
  },
  {
    key: 2,
    message: 'Ошибка — error',
    status: 'error',
    title: 'Error',
    withCloseButton: true,
    icon: <IconWarning size={"m"}/>,
  },
  {
    key: 3,
    message: 'Предупреждение — warning',
    status: 'warning',
    title: 'Warning',
    withCloseButton: true,
    icon: <IconInfo size={"m"}/>,
  },
  {
    key: 4,
    message: 'Успех — success',
    status: 'success',
    title: 'Success',
    withCloseButton: true,
    icon: <IconCheck size={"m"}/>,
  },
  {
    key: 5,
    message: 'Системное — system',
    status: 'system',
    title: 'System',
    withCloseButton: true,
    icon: <IconInfo size={"m"}/>,
  },
];

<Notification items={items} />
```

## Внешний вид

Внешний вид задачется свойством `view` . Возможные значения: 'outlined', 'filled'

<NotificationExampleView />

```tsx
const itemsFilled: Item[] = [
  {
    key: 1,
    message: 'Сообщение — info',
    status: 'info',
    view: "filled",
    withCloseButton: true,
    icon: <IconInfo size={"xs"}/>
  },
  {
    key: 2,
    message: 'Ошибка — error',
    status: 'error',
    view: "filled",
    withCloseButton: true,
    icon: <IconWarning size={"xs"}/>
  },
  {
    key: 3,
    message: 'Предупреждение — warning',
    status: 'warning',
    view: "filled",
    withCloseButton: true,
    icon: <IconInfo size={"xs"}/>
  },
  {
    key: 4,
    message: 'Успех — success',
    status: 'success',
    view: "filled",
    withCloseButton: true,
    icon: <IconCheck size={"xs"}/>
  },
  {
    key: 5,
    message: 'Системное — system',
    status: 'system',
    view: "filled",
    withCloseButton: true,
    icon: <IconInfo size={"xs"}/>
  },
];

const itemsOutlined: Item[] = [
  {
    key: 1,
    message: 'Сообщение — info',
    status: 'info',
    view: "outlined",
    withCloseButton: true,
    icon: <IconInfo size={"m"}/>,
    onlyMessage: true
  },
  {
    key: 2,
    message: 'Ошибка — error',
    status: 'error',
    view: "outlined",
    withCloseButton: true,
    icon: <IconWarning size={"m"}/>,
    onlyMessage: true
  },
  {
    key: 3,
    message: 'Предупреждение — warning',
    status: 'warning',
    view: "outlined",
    withCloseButton: true,
    icon: <IconInfo size={"m"}/>,
    onlyMessage: true
  },
  {
    key: 4,
    message: 'Успех — success',
    status: 'success',
    view: "outlined",
    withCloseButton: true,
    icon: <IconCheck size={"m"}/>,
    onlyMessage: true
  },
  {
    key: 5,
    message: 'Системное — system',
    status: 'system',
    view: "outlined",
    withCloseButton: true,
    icon: <IconInfo size={"m"}/>,
    onlyMessage: true
  },
];

<Notification items={itemsOutlined}  />
<Notification items={itemsFilled}  />
```


## Иконка

Добавьте любую из [библиотеки иконок](?path=/story/components-icons--playground) с помощью свойства `icon`.

<NotificationExampleIcon />

```tsx
const items: Item[] = [
  {
    key: 1,
    title: 'Info',
    status: "info",
    message: 'Интернет внезапно кончился',
    icon: <IconInfo size={"m"}/>
  },
  {
    key: 2,
    title: 'Error',
    status: "error",
    message: 'Интернет внезапно кончился',
    icon: <IconWarning size={"m"}/>
  },
  {
    key: 3,
    title: 'Warning',
    status: "warning",
    message: 'Интернет внезапно кончился',
    icon: <IconInfo size={"m"}/>
  },
  {
    key: 4,
    title: 'Success',
    status: "success",
    message: 'Интернет внезапно кончился',
    icon: <IconCheckC size={"m"}/>
  },
  {
    key: 5,
    title: 'System',
    status: "system",
    message: 'Интернет внезапно кончился',
    icon: <IconSettings size={"m"}/>
  }
];

<Notification items={items} />
```

## Кнопки

Добавьте кнопки, если хотите, чтобы пользователь мог отреагировать на событие.
Например, отменить его или куда-то перейти.

Добавить кнопку Закрытие можно добавив свойство `withCloseButton = true` в items

<NotificationExampleButtons />

```tsx
const items: Item[] = [
  {
    key: 1,
    icon: <IconInfo size={"m"}/>,
    title: 'Это предлежение для вас',
    message: 'С ним нельзя не согласиться',
    status: 'info',
    actions: [
      {
        label: 'Да',
        onClick: () => {
          console.log('Да');
        },
        iconLeft: IconCheck,
      },
      {
        label: 'Нет',
        onClick: () => {
          console.log('Нет');
        },
        iconLeft: IconBlock,
        view: "secondary"
      }
    ],
    withCloseButton: true
  },
];

<Notification items={items} />
```

## Работа со списком уведомлений

Используйте встроенную функцию `reducer` для управления списком уведомлений.

Для этого необходимо все уведомления добавлять в список ` dispatchItems({ type: 'add', item })`
И также удалять на onClose `dispatchItems({ type: 'remove', item, key })`

```tsx
import {reducer} from "nx-design/Notification";

export function MyComponent() {
  const [items, dispatchItems] = useReducer(reducer, []);

  const generateNotification = () => () => {
    const key = items.length + 1;
    const item: Item = {
      key,
      message: 'Любое сообщение',
      icon: IconInfo,
      onClose: () => dispatchItems({ type: 'remove', item, key }),
    };
    dispatchItems({ type: 'add', item });
  };
}
```

## Таймер

Используйте таймер, если сообщений о событиях слишком много и они не очень важные.
Тогда сообщение будет держаться на экране некоторое время, а потом исчезнет.

Таймер нужен, чтобы дать пользователю возможность поменять решение. Например,
если пользователь что-то удалил, можно вывести внизу снекбар с таймером и кнопкой
**Не удалять**. Если пользователь, нажмет на кнопку. Если нет, сообщение само закроется
по таймеру.

Таймер можно добавить с помощью `autoClose`.

<NotificationExampleTimer />

## Свойства

```tsx
type Item = {
  key: string | number;
  message?: string | number;
  title?: string | number;
  status?: 'success' | 'warning' | 'error' | 'info';
  view?: NotificationItemView;
  autoClose?: boolean | number;
  icon?: React.FC<IconProps> | React.ReactNode;
  actions?: NotificationPropItemAction[];
  onClose?: (item: Item) => void;
  withCloseButton?: boolean;
  onlyMessage?: boolean;
  onAutoClose?: (item: Item) => void; // Если не передавать `onAutoClose` то по истечению таймера будет срабатывать `onClose`
};

type NotificationPropItemAction = {
  label: string | number;
  onClick: React.EventHandler<React.MouseEvent>;
  iconLeft?: IconComponent;
  iconSize?: IconPropSize;
  view?: ButtonPropView;
};

const notificationItemView = ['outlined', 'filled'] as const;
type NotificationItemView = typeof notificationItemView[number];
```

| Свойство item    | Тип                                                                    | По умолчанию | Описание                                                         |
| ---------------- | ---------------------------------------------------------------------- | ------------ | ---------------------------------------------------------------- |
| items            | `Item[]`                                                               | -            | Массив элементов                                                 |
| title            | `string`                                                               | -            | Заголовок сообщения                                              |
| message          | `string`                                                               | -            | Текст сообщения                                                  |
| autoClose        | `boolean`, `number`                                                    | `false`      | Автоматическое закрытие через 5 секунд                           |
| actions          | `NotificationPropItemAction[]`                                         | -            | Массив кнопок с действиями                                       |
| onClose          | (item: Item) => void                                                   | -            |                                                                  |
| onAutoClose      | (item: Item) => void                                                   | -            |                                                                  |
| status?          | `'info'`, `'system'`, `'success'`, `'warning'`, `'error'`              | -            | Статус уведомления                                               |
| view?            | `'outlined'`, `'filled'`                                               | `'outlined'` | Внешний вид уведомления                                          |
| icon?            | `React.FC<IconProps>`, `React.ReactNode`                               | -            | Иконка с левой стороны уведомления                               |
| className?       | `string`                                                               | -            | Дополнительный класс                                             |
| withCloseButton? | `boolean`                                                              | `false`      | Отображает кнопку закрытия                                       |
| onlyMessage?     | `boolean`                                                              | `false`      | Применяются специальные стили, если только текст, без заголовка  |

## Пример

```ts
import * as React from 'react';
import { Notification } from 'nx-design/Notification';

function NotificationExample() {
  const items = [
    {
      key: 1,
      message: 'Сообщение',
    },
  ];
  return <Notification items={items} />;
}
```

<NotificationExampleSimple />

## Пример с кнопками

```tsx
import './NotificationExampleWithButtons.css';

import React, {useReducer} from 'react';

import {IconProps} from '../../../../../icons/_Icon/Icon';
import {IconPlus} from '../../../../../icons/IconPlus/IconPlus';
import {cn} from '../../../../../utils/bem';
import {Button} from '../../../../Button/Button';
import {Item, Notification, NotificationItemStatus} from '../../../Notification';
import {IconSettings} from "../../../../../icons/IconSettings/IconSettings";
import {IconCheckC} from "../../../../../icons/IconCheckC/IconCheckC";
import {IconInfo} from "../../../../../icons/IconInfo/IconInfo";
import {IconWarning} from "../../../../../icons/IconWarning/IconWarning";
import {cnDocsDecorator} from '../../../../../uiKit/components/DocsDecorator/DocsDecorator';

type State = Item[];
type Action = { type: 'add'; item: Item } | { type: 'remove'; key: number | string };

const cnNotificationExampleWithButtons = cn('NotificationExampleWithButtons');

const getItemIconByStatus = (status: NotificationItemStatus): React.FC<IconProps> | undefined => {
  const mapIconByStatus: Record<NotificationItemStatus, React.FC<IconProps>> = {
    success: IconCheckC,
    warning: IconInfo,
    error: IconWarning,
    system: IconSettings,
    info: IconInfo
  };
  return mapIconByStatus[status];
};

function reducer(state: State, action: Action) {
  switch (action.type) {
    case 'add':
      return [...state, action.item];
    case 'remove':
      return state.filter((item) => item.key !== action.key);
  }
}

export function NotificationExampleWithButtons() {
  const [items, dispatchItems] = useReducer(reducer, []);
  const generateHandleAdd = (status: NotificationItemStatus) => () => {
    const key = items.length + 1;
    const item: Item = {
      key,
      message: `Сообщение о каком-то событии - ${key}`,
      status,
      icon: getItemIconByStatus(status),
      onClose: () => dispatchItems({ type: 'remove', key }),
      withCloseButton: true
    };
    dispatchItems({ type: 'add', item });
  };

  const handleSuccessAdd = generateHandleAdd('success');
  const handleWarningAdd = generateHandleAdd('warning');
  const handleAlertAdd = generateHandleAdd('error');
  const handleSystemAdd = generateHandleAdd('system');
  const handleNormalAdd = generateHandleAdd('info');

  React.useEffect(() => handleNormalAdd(), []);

  return (
    <div className={cnNotificationExampleWithButtons('', [cnDocsDecorator('Section')])}>
      <div className={cnNotificationExampleWithButtons('Buttons')}>
        <Button
          className={cnNotificationExampleWithButtons('ButtonAdd')}
          iconLeft={IconPlus}
          label="Выполненно"
          onClick={handleSuccessAdd}
        />
        <Button
          className={cnNotificationExampleWithButtons('ButtonAdd')}
          iconLeft={IconPlus}
          label="Ошибка"
          onClick={handleAlertAdd}
        />
        <Button
          className={cnNotificationExampleWithButtons('ButtonAdd')}
          iconLeft={IconPlus}
          label="Предупреждение"
          onClick={handleWarningAdd}
        />
        <Button
          className={cnNotificationExampleWithButtons('ButtonAdd')}
          iconLeft={IconPlus}
          label="Системное"
          onClick={handleSystemAdd}
        />
        <Button
          className={cnNotificationExampleWithButtons('ButtonAdd')}
          iconLeft={IconPlus}
          label="Нормальное"
          onClick={handleNormalAdd}
        />
      </div>
      <Notification className={cnNotificationExampleWithButtons('Notification')} items={items} />
    </div>
  );
}
```

```css
.NotificationExampleWithButtons {
  display: flex;
  flex-direction: row;
  height: 400px;

  &-Notification {
    position: unset;
    overflow: auto;
    flex: none;
    width: 400px;
    padding-right: var(--space-xs);
    padding-left: var(--space-xs);
   }

  &-Buttons {
    display: flex;
    flex-direction: column;
    flex: 1;
    justify-content: flex-end;
    align-items: end;
    max-width: 200px;
    padding-right: var(--space-xs);
    padding-left: var(--space-xs);
  }

  &-ButtonAdd {
    margin-bottom: var(--space-xs);
  }
}
```

<NotificationExampleWithButtons />
